import wfdb  # Para leer seÃ±ales fisiolÃ³gicas
import numpy as np  # Para manejar datos numÃ©ricos
import plotly.graph_objects as go  # Para graficar

# ğŸ“‚ Ruta del archivo SIN extensiÃ³n (coloca la ruta exacta)
record_path = r"C:/Users/marce/Documents/LAB - PROC. SEÃ‘ALES/LAB 1/SeÃ±al - Neuropatia EMG/emg_neuropathy"
record_path = r"C:/Users/marce/Documents/LAB - PROC. SEÃ‘ALES/LAB 1/SeÃ±al - Neuropatia EMG/emg_neuropathy"


try:
    # ğŸ”¹ Cargar la seÃ±al con wfdb
    record = wfdb.rdrecord(record_path)  # Lee los archivos .dat y .hea
    signal = record.p_signal  # Extraer la seÃ±al
    fs = record.fs  # Obtener la frecuencia de muestreo
    num_canales = record.n_sig  # NÃºmero de canales

    # ğŸ”¹ Mostrar informaciÃ³n de la seÃ±al
    print("ğŸ“Œ InformaciÃ³n de la seÃ±al:")
    print(f"- Nombre del registro: {record.record_name}")
    print(f"- Frecuencia de muestreo: {fs} Hz")
    print(f"- DuraciÃ³n: {len(signal) / fs:.2f} segundos")
    print(f"- NÃºmero de canales: {num_canales}")

    # ğŸ”¹ Convertir el tiempo en segundos
    tiempo = np.arange(len(signal)) / fs  

    # ğŸ”¹ Crear la figura
    fig = go.Figure()

    # ğŸ”¹ Graficar cada canal de la seÃ±al
    for i in range(num_canales):
        fig.add_trace(go.Scatter(x=tiempo, y=signal[:, i], mode="lines", name=f"Canal {i+1}"))

    # ğŸ”¹ Personalizar el grÃ¡fico
    fig.update_layout(
        title="SeÃ±al EMG NeuropatÃ­a - PhysioNet",
        xaxis_title="Tiempo (s)",
        yaxis_title="Amplitud",
        template="plotly_dark",
        hovermode="x",
    )

    # ğŸ”¹ Mostrar grÃ¡fico interactivo
    fig.show()

except FileNotFoundError:
    print("âŒ ERROR: No se encontraron los archivos .dat y .hea en la ruta indicada.")
    print("ğŸ”¹ Verifica que el archivo estÃ© en:", record_path)
    print("ğŸ”¹ AsegÃºrate de escribir bien el nombre del archivo sin la extensiÃ³n.")

except Exception as e:
    print("âŒ ERROR inesperado:", e)
